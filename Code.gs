// Code.gs - ‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡∏ö‡∏ö
function onOpen() {
  try {
    var ui = SpreadsheetApp.getUi();
    createMenu(ui);
  } catch (e) {
    console.log('Error in onOpen: ' + e.toString());
  }
}

function createMenu(ui) {
  ui.createMenu('üö® ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏£‡∏Ñ‡∏£‡∏∞‡∏ö‡∏≤‡∏î‡∏™‡∏±‡∏ï‡∏ß‡πå')
    .addItem('üìù ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Form', 'createGoogleForm')
    .addItem('üåê ‡∏™‡∏£‡πâ‡∏≤‡∏á Web Form', 'deployWebApp')
    .addItem('üìä ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', 'viewAllReports')
    .addSeparator()
    .addItem('‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤', 'showSettings')
    .addItem('‚ÑπÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ', 'showInstructions')
    .addToUi();
}

function createGoogleForm() {
  // ... (‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°)
  // ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß
}

function deployWebApp() {
  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≤‡∏Å WebApp.gs
  try {
    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô deployWebApp ‡∏à‡∏≤‡∏Å WebApp.gs
    var result = eval('deployWebApp')();
    return result;
  } catch (error) {
    Logger.log('Error calling deployWebApp: ' + error.toString());
    
    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ó‡∏ô
    var ui = SpreadsheetApp.getUi();
    ui.alert(
      'Web Form',
      '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Web Form ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...\n\n' +
      '‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Web Form ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ:\n' +
      '1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π Run ‚Üí deployWebApp\n' +
      '2. ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå: https://script.google.com/macros/s/' + ScriptApp.getScriptId() + '/exec',
      ui.ButtonSet.OK
    );
  }
}


// WebApp.gs - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Web Form ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
function doGet() {
  return HtmlService.createTemplateFromFile('WebFormPage')
    .evaluate()
    .setTitle('‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏£‡∏Ñ‡∏£‡∏∞‡∏ö‡∏≤‡∏î‡∏™‡∏±‡∏ï‡∏ß‡πå - ‡∏Å‡∏£‡∏°‡∏õ‡∏®‡∏∏‡∏™‡∏±‡∏ï‡∏ß‡πå')
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL)
    .addMetaTag('viewport', 'width=device-width, initial-scale=1.0');
}

function getProvincesData() {
  return {
    provinces: getProvincesList(),
    districts: getDistrictsData()
  };
}

function getProvincesList() {
  return [
    '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', '‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà', '‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£', '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô',
    '‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤', '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó', '‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥',
    '‡∏ä‡∏∏‡∏°‡∏û‡∏£', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', '‡∏ï‡∏£‡∏±‡∏á', '‡∏ï‡∏£‡∏≤‡∏î',
    '‡∏ï‡∏≤‡∏Å', '‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å', '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', '‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°', '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤',
    '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', '‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå', '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™', '‡∏ô‡πà‡∏≤‡∏ô',
    '‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨', '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå', '‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ',
    '‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ', '‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', '‡∏û‡∏±‡∏á‡∏á‡∏≤', '‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á', '‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£',
    '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡πÅ‡∏û‡∏£‡πà', '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï',
    '‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°', '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', '‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô', '‡∏¢‡πÇ‡∏™‡∏ò‡∏£', '‡∏¢‡∏∞‡∏•‡∏≤',
    '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î', '‡∏£‡∏∞‡∏ô‡∏≠‡∏á', '‡∏£‡∏∞‡∏¢‡∏≠‡∏á', '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ',
    '‡∏•‡∏≥‡∏õ‡∏≤‡∏á', '‡∏•‡∏≥‡∏û‡∏π‡∏ô', '‡πÄ‡∏•‡∏¢', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©', '‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£',
    '‡∏™‡∏á‡∏Ç‡∏•‡∏≤', '‡∏™‡∏ï‡∏π‡∏•', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£',
    '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß', '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢', '‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ',
    '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢', '‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π', '‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á',
    '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç', '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå', '‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ'
  ].sort();
}

function getDistrictsData() {
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
  return {
    '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£': ['‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£', '‡∏î‡∏∏‡∏™‡∏¥‡∏ï', '‡∏´‡∏ô‡∏≠‡∏á‡∏à‡∏≠‡∏Å', '‡∏ö‡∏≤‡∏á‡∏£‡∏±‡∏Å', '‡∏ö‡∏≤‡∏á‡πÄ‡∏Ç‡∏ô', '‡∏ö‡∏≤‡∏á‡∏Å‡∏∞‡∏õ‡∏¥', '‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô', '‡∏õ‡πâ‡∏≠‡∏°‡∏õ‡∏£‡∏≤‡∏ö‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡πà‡∏≤‡∏¢', '‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á', '‡∏°‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ'],
    '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', '‡∏à‡∏≠‡∏°‡∏ó‡∏≠‡∏á', '‡πÅ‡∏°‡πà‡πÅ‡∏à‡πà‡∏°', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏î‡∏≤‡∏ß', '‡∏î‡∏≠‡∏¢‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î', '‡πÅ‡∏°‡πà‡πÅ‡∏ï‡∏á', '‡πÅ‡∏°‡πà‡∏£‡∏¥‡∏°', '‡∏™‡∏∞‡πÄ‡∏°‡∏¥‡∏á', '‡∏ù‡∏≤‡∏á', '‡πÅ‡∏°‡πà‡∏≠‡∏≤‡∏¢'],
    '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', '‡∏ö‡πâ‡∏≤‡∏ô‡∏ù‡∏≤‡∏á', '‡∏û‡∏£‡∏∞‡∏¢‡∏∑‡∏ô', '‡∏´‡∏ô‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠', '‡∏ä‡∏∏‡∏°‡πÅ‡∏û', '‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π', '‡∏ô‡πâ‡∏≥‡∏û‡∏≠‡∏á', '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏±‡∏ï‡∏ô‡πå', '‡∏Å‡∏£‡∏∞‡∏ô‡∏ß‡∏ô', '‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏ú‡πà'],
    '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', '‡∏Ñ‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡πÄ‡∏™‡∏¥‡∏á‡∏™‡∏≤‡∏á', '‡∏Ñ‡∏á', '‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°', '‡∏à‡∏±‡∏Å‡∏£‡∏≤‡∏ä', '‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏±‡∏¢', '‡∏î‡πà‡∏≤‡∏ô‡∏Ç‡∏∏‡∏ô‡∏ó‡∏î', '‡πÇ‡∏ô‡∏ô‡πÑ‡∏ó‡∏¢', '‡πÇ‡∏ô‡∏ô‡∏™‡∏π‡∏á'],
    '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏®‡∏£‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', '‡πÇ‡∏Ç‡∏á‡πÄ‡∏à‡∏µ‡∏¢‡∏°', '‡πÄ‡∏Ç‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏ô', '‡πÄ‡∏Ç‡∏°‡∏£‡∏≤‡∏ê', '‡πÄ‡∏î‡∏ä‡∏≠‡∏∏‡∏î‡∏°', '‡∏ô‡∏≤‡∏à‡∏∞‡∏´‡∏•‡∏ß‡∏¢', '‡∏ô‡πâ‡∏≥‡∏¢‡∏∑‡∏ô', '‡∏ö‡∏∏‡∏ì‡∏ë‡∏£‡∏¥‡∏Å', '‡∏ï‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏∑‡∏ä‡∏ú‡∏•'],
    '‡∏™‡∏á‡∏Ç‡∏•‡∏≤': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏á‡∏Ç‡∏•‡∏≤', '‡∏™‡∏ó‡∏¥‡∏á‡∏û‡∏£‡∏∞', '‡∏à‡∏∞‡∏ô‡∏∞', '‡∏ô‡∏≤‡∏ó‡∏ß‡∏µ', '‡πÄ‡∏ó‡∏û‡∏≤', '‡∏™‡∏∞‡∏ö‡πâ‡∏≤‡∏¢‡πâ‡∏≠‡∏¢', '‡∏£‡∏∞‡πÇ‡∏ô‡∏î', '‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏£‡∏±‡∏ï‡∏†‡∏π‡∏°‡∏¥', '‡∏™‡∏∞‡πÄ‡∏î‡∏≤'],
    '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ö‡πâ‡∏≤‡∏ô‡∏ö‡∏∂‡∏á', '‡∏´‡∏ô‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà', '‡∏ö‡∏≤‡∏á‡∏•‡∏∞‡∏°‡∏∏‡∏á', '‡∏û‡∏≤‡∏ô‡∏ó‡∏≠‡∏á', '‡∏û‡∏ô‡∏±‡∏™‡∏ô‡∏¥‡∏Ñ‡∏°', '‡∏®‡∏£‡∏µ‡∏£‡∏≤‡∏ä‡∏≤', '‡πÄ‡∏Å‡∏≤‡∏∞‡∏™‡∏µ‡∏ä‡∏±‡∏á', '‡∏™‡∏±‡∏ï‡∏´‡∏µ‡∏ö', '‡∏ö‡πà‡∏≠‡∏ó‡∏≠‡∏á'],
    '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô', '‡∏ô‡∏Ñ‡∏£‡∏ä‡∏±‡∏¢‡∏®‡∏£‡∏µ', '‡∏î‡∏≠‡∏ô‡∏ï‡∏π‡∏°', '‡∏ö‡∏≤‡∏á‡πÄ‡∏•‡∏ô', '‡∏™‡∏≤‡∏°‡∏û‡∏£‡∏≤‡∏ô', '‡∏û‡∏∏‡∏ó‡∏ò‡∏°‡∏ì‡∏ë‡∏•'],
    '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ß‡∏¢', '‡∏ö‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà', '‡∏ö‡∏≤‡∏á‡∏ö‡∏±‡∏ß‡∏ó‡∏≠‡∏á', '‡πÑ‡∏ó‡∏£‡∏ô‡πâ‡∏≠‡∏¢', '‡∏õ‡∏≤‡∏Å‡πÄ‡∏Å‡∏£‡πá‡∏î'],
    '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏Ñ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á', '‡∏ò‡∏±‡∏ç‡∏ö‡∏∏‡∏£‡∏µ', '‡∏´‡∏ô‡∏≠‡∏á‡πÄ‡∏™‡∏∑‡∏≠', '‡∏•‡∏≤‡∏î‡∏´‡∏•‡∏∏‡∏°‡πÅ‡∏Å‡πâ‡∏ß', '‡∏•‡∏≥‡∏•‡∏π‡∏Å‡∏Å‡∏≤', '‡∏™‡∏≤‡∏°‡πÇ‡∏Ñ‡∏Å'],
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏î‡∏¥‡∏©‡∏ê‡πå', '‡∏î‡∏≠‡∏ô‡∏™‡∏±‡∏Å', '‡πÄ‡∏Å‡∏≤‡∏∞‡∏™‡∏°‡∏∏‡∏¢', '‡πÄ‡∏Å‡∏≤‡∏∞‡∏û‡∏∞‡∏á‡∏±‡∏ô', '‡πÑ‡∏ä‡∏¢‡∏≤', '‡∏ó‡πà‡∏≤‡∏ä‡∏ô‡∏∞', '‡∏Ñ‡∏µ‡∏£‡∏µ‡∏£‡∏±‡∏ê‡∏ô‡∏¥‡∏Ñ‡∏°'],
    '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', '‡πÄ‡∏ß‡∏µ‡∏¢‡∏á‡∏ä‡∏±‡∏¢', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏Ç‡∏≠‡∏á', '‡πÄ‡∏ó‡∏¥‡∏á', '‡∏û‡∏≤‡∏ô', '‡∏õ‡πà‡∏≤‡πÅ‡∏î‡∏î', '‡πÅ‡∏°‡πà‡∏à‡∏±‡∏ô', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÅ‡∏™‡∏ô'],
    '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', '‡∏û‡∏£‡∏´‡∏°‡∏Ñ‡∏µ‡∏£‡∏µ', '‡∏•‡∏≤‡∏ô‡∏™‡∏Å‡∏≤', '‡∏â‡∏ß‡∏≤‡∏á', '‡∏û‡∏¥‡∏õ‡∏π‡∏ô', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡πÉ‡∏´‡∏ç‡πà', '‡∏ä‡∏∞‡∏≠‡∏ß‡∏î', '‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤'],
    '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏Å‡∏∏‡∏î‡∏à‡∏±‡∏ö', '‡∏´‡∏ô‡∏≠‡∏á‡∏ß‡∏±‡∏ß‡∏ã‡∏≠', '‡∏Å‡∏∏‡∏°‡∏†‡∏ß‡∏≤‡∏õ‡∏µ', '‡πÇ‡∏ô‡∏ô‡∏™‡∏∞‡∏≠‡∏≤‡∏î', '‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏≤‡∏ô', '‡∏ó‡∏∏‡πà‡∏á‡∏ù‡∏ô', '‡πÑ‡∏ä‡∏¢‡∏ß‡∏≤‡∏ô'],
    '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', '‡∏Ñ‡∏π‡πÄ‡∏°‡∏∑‡∏≠‡∏á', '‡∏Å‡∏£‡∏∞‡∏™‡∏±‡∏á', '‡∏ô‡∏≤‡∏á‡∏£‡∏≠‡∏á', '‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏µ‡πà', '‡∏•‡∏∞‡∏´‡∏≤‡∏ô‡∏ó‡∏£‡∏≤‡∏¢', '‡∏õ‡∏£‡∏∞‡πÇ‡∏Ñ‡∏ô‡∏ä‡∏±‡∏¢', '‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡∏£‡∏ß‡∏î'],
    '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏ä‡∏∏‡∏°‡∏û‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ó‡πà‡∏≤‡∏ï‡∏π‡∏°', '‡∏à‡∏≠‡∏°‡∏û‡∏£‡∏∞', '‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó', '‡∏Å‡∏≤‡∏ö‡πÄ‡∏ä‡∏¥‡∏á', '‡∏£‡∏±‡∏ï‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏ô‡∏°'],
    '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©', '‡∏¢‡∏≤‡∏á‡∏ä‡∏∏‡∏°‡∏ô‡πâ‡∏≠‡∏¢', '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏£‡∏°‡∏¢‡πå', '‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏•‡∏±‡∏Å‡∏©‡πå', '‡∏Ç‡∏∏‡∏Ç‡∏±‡∏ô‡∏ò‡πå', '‡πÑ‡∏û‡∏£‡∏ö‡∏∂‡∏á', '‡∏õ‡∏£‡∏≤‡∏á‡∏Ñ‡πå‡∏Å‡∏π‡πà', '‡∏Ç‡∏∏‡∏ô‡∏´‡∏≤‡∏ç'],
    '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î': ['‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î', '‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ß‡∏¥‡∏™‡∏±‡∏¢', '‡∏õ‡∏ó‡∏∏‡∏°‡∏£‡∏±‡∏ï‡∏ï‡πå', '‡∏à‡∏ï‡∏∏‡∏£‡∏û‡∏±‡∏Å‡∏ï‡∏£‡∏û‡∏¥‡∏°‡∏≤‡∏ô', '‡∏ò‡∏ß‡∏±‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', '‡∏û‡∏ô‡∏°‡πÑ‡∏û‡∏£', '‡πÇ‡∏û‡∏ô‡∏ó‡∏≠‡∏á', '‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏ä‡∏±‡∏¢']
  };
}

function getDistrictsByProvince(province) {
  var districtsData = getDistrictsData();
  
  if (districtsData[province]) {
    return districtsData[province].sort();
  } else {
    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏±‡πâ‡∏ô
    return ['‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á'];
  }
}

function getDiseasesList() {
  return [
    {group: '‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏ô‡∏°', diseases: [
      '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡πâ‡∏≤‡πÄ‡∏õ‡∏∑‡πà‡∏≠‡∏¢',
      '‡πÇ‡∏£‡∏Ñ‡∏Æ‡∏µ‡πÇ‡∏°‡∏£‡∏≤‡∏¢‡∏¥‡∏Å‡πÄ‡∏ã‡∏õ‡∏ï‡∏¥‡∏ã‡∏µ‡πÄ‡∏°‡∏µ‡∏¢ (‡πÇ‡∏£‡∏Ñ‡∏Ñ‡∏≠‡∏ö‡∏ß‡∏°)',
      '‡πÇ‡∏£‡∏Ñ‡πÅ‡∏ó‡πâ‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÉ‡∏ô‡πÇ‡∏Ñ (‡∏ö‡∏£‡∏π‡πÄ‡∏ã‡∏•‡πÇ‡∏•‡∏ã‡∏¥‡∏™)',
      '‡πÇ‡∏£‡∏Ñ‡∏û‡∏¢‡∏≤‡∏ò‡∏¥‡πÉ‡∏ö‡πÑ‡∏°‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ö',
      '‡πÇ‡∏£‡∏Ñ‡πÄ‡∏•‡∏õ‡πÇ‡∏ï‡∏™‡πÑ‡∏õ‡πÇ‡∏£‡∏ã‡∏¥‡∏™'
    ]},
    {group: '‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏õ‡∏µ‡∏Å', diseases: [
      '‡πÇ‡∏£‡∏Ñ‡∏ô‡∏¥‡∏ß‡∏Ñ‡∏≤‡∏™‡πÄ‡∏ã‡∏¥‡∏•',
      '‡πÇ‡∏£‡∏Ñ‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏Å',
      '‡πÇ‡∏£‡∏Ñ‡∏≠‡∏´‡∏¥‡∏ß‡∏≤‡∏ï‡πå‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏õ‡∏µ‡∏Å',
      '‡πÇ‡∏£‡∏Ñ‡∏´‡∏•‡∏≠‡∏î‡∏•‡∏°‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠',
      '‡πÇ‡∏£‡∏Ñ‡∏ù‡∏µ‡∏î‡∏≤‡∏©‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏õ‡∏µ‡∏Å'
    ]},
    {group: '‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ô‡∏™‡∏∏‡∏Å‡∏£', diseases: [
      '‡πÇ‡∏£‡∏Ñ‡∏≠‡∏´‡∏¥‡∏ß‡∏≤‡∏ï‡πå‡πÅ‡∏≠‡∏ü‡∏£‡∏¥‡∏Å‡∏≤‡πÉ‡∏ô‡∏™‡∏∏‡∏Å‡∏£ (ASF)',
      '‡πÇ‡∏£‡∏Ñ‡∏û‡∏µ‡∏≠‡∏≤‡∏£‡πå‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏≠‡∏™ (PRRS)',
      '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡πâ‡∏≤‡πÄ‡∏õ‡∏∑‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡∏™‡∏∏‡∏Å‡∏£',
      '‡πÇ‡∏£‡∏Ñ‡∏ö‡∏¥‡∏î'
    ]},
    {group: '‡πÇ‡∏£‡∏Ñ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', diseases: [
      '‡πÇ‡∏£‡∏Ñ‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤',
      '‡πÇ‡∏£‡∏Ñ‡πÅ‡∏≠‡∏ô‡πÅ‡∏ó‡∏£‡∏Å‡∏ã‡πå',
      '‡πÇ‡∏£‡∏Ñ‡∏û‡∏¢‡∏≤‡∏ò‡∏¥‡∏ï‡∏±‡∏ß‡∏ï‡∏∑‡∏î',
      '‡πÇ‡∏£‡∏Ñ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡πÉ‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏)'
    ]}
  ];
}

function submitWebForm(formData) {
  try {
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    if (!validateFormData(formData)) {
      return {
        success: false,
        message: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'
      };
    }
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î Spreadsheet
    var spreadsheet = getWebFormSpreadsheet();
    var sheet = spreadsheet.getActiveSheet();
    
    // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    var timestamp = new Date();
    var rowData = [
      timestamp,
      formData.fullName,
      formData.idCard,
      formData.phoneNumber,
      formData.email || '',
      formData.province,
      formData.district,
      formData.address,
      formData.animalType,
      formData.animalCount || '',
      formData.disease,
      formData.treatment,
      formData.symptoms || '',
      formData.notes || ''
    ];
    
    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    sheet.appendRow(rowData);
    
    return {
      success: true,
      message: '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n\n‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\n‡∏Å‡∏£‡∏°‡∏õ‡∏®‡∏∏‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á\n\n‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô: WF-' + Utilities.getUuid().substring(0, 8).toUpperCase(),
      timestamp: timestamp.toLocaleString('th-TH')
    };
    
  } catch (error) {
    console.error('Error submitting web form:', error);
    return {
      success: false,
      message: '‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.toString()
    };
  }
}

function validateFormData(formData) {
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
  if (!formData.fullName || !formData.idCard || !formData.phoneNumber) {
    return false;
  }
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
  if (!/^\d{13}$/.test(formData.idCard)) {
    return false;
  }
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå
  if (!/^\d{10}$/.test(formData.phoneNumber)) {
    return false;
  }
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
  if (!formData.province || !formData.district) {
    return false;
  }
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏£‡∏Ñ
  if (!formData.animalType || !formData.disease) {
    return false;
  }
  
  return true;
}

function getWebFormSpreadsheet() {
  var scriptProperties = PropertiesService.getScriptProperties();
  var spreadsheetId = scriptProperties.getProperty('webform_spreadsheet_id');
  
  if (spreadsheetId) {
    try {
      return SpreadsheetApp.openById(spreadsheetId);
    } catch (e) {
      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
      return createWebFormSpreadsheet();
    }
  } else {
    return createWebFormSpreadsheet();
  }
}

function createWebFormSpreadsheet() {
  var date = new Date();
  var dateString = Utilities.formatDate(date, Session.getScriptTimeZone(), 'yyyyMMdd');
  var spreadsheetName = 'WebForm_‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏£‡∏Ñ‡∏£‡∏∞‡∏ö‡∏≤‡∏î‡∏™‡∏±‡∏ï‡∏ß‡πå_' + dateString;
  
  var spreadsheet = SpreadsheetApp.create(spreadsheetName);
  var sheet = spreadsheet.getActiveSheet();
  
  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
  var headers = [
    'Timestamp',
    '‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•',
    '‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
    '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå',
    '‡∏≠‡∏µ‡πÄ‡∏°‡∏•',
    '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',
    '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡πÄ‡∏Ç‡∏ï',
    '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà',
    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ï‡∏ß‡πå',
    '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏õ‡πà‡∏ß‡∏¢',
    '‡πÇ‡∏£‡∏Ñ‡∏ó‡∏µ‡πà‡∏û‡∏ö',
    '‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤',
    '‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏ö',
    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏'
  ];
  
  sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
  sheet.getRange(1, 1, 1, headers.length).setFontWeight('bold');
  sheet.setFrozenRows(1);
  sheet.autoResizeColumns(1, headers.length);
  
  // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ID
  PropertiesService.getScriptProperties()
    .setProperty('webform_spreadsheet_id', spreadsheet.getId());
  
  return spreadsheet;
}

function deployWebApp() {
  try {
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á deployment ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Web App
    var scriptId = ScriptApp.getScriptId();
    var webAppUrl = 'https://script.google.com/macros/s/' + scriptId + '/exec';
    
    var html = HtmlService.createHtmlOutput(
      '<!DOCTYPE html>' +
      '<html>' +
      '<head>' +
      '<style>' +
      'body { font-family: Arial, sans-serif; padding: 40px; text-align: center; }' +
      '.container { max-width: 600px; margin: 0 auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }' +
      '.success-icon { font-size: 60px; color: #2c7a3e; margin-bottom: 20px; }' +
      '.url-box { background: #f8f9fa; border: 2px solid #2c7a3e; border-radius: 8px; padding: 15px; margin: 20px 0; word-break: break-all; }' +
      '.button { background: #2c7a3e; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; margin: 10px; text-decoration: none; display: inline-block; }' +
      '</style>' +
      '<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">' +
      '</head>' +
      '<body>' +
      '<div class="container">' +
      '<div class="success-icon"><i class="fas fa-globe"></i></div>' +
      '<h1>üåê Web Form ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!</h1>' +
      '<p>URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏£‡∏Ñ‡∏£‡∏∞‡∏ö‡∏≤‡∏î‡∏™‡∏±‡∏ï‡∏ß‡πå:</p>' +
      '<div class="url-box"><strong>' + webAppUrl + '</strong></div>' +
      '<p>‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÇ‡∏£‡∏Ñ‡∏£‡∏∞‡∏ö‡∏≤‡∏î‡∏™‡∏±‡∏ï‡∏ß‡πå</p>' +
      '<div>' +
      '<a href="' + webAppUrl + '" target="_blank" class="button">üìù ‡πÄ‡∏õ‡∏¥‡∏î Web Form</a>' +
      '<button class="button" onclick="copyUrl()">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL</button>' +
      '</div>' +
      '</div>' +
      '<script>' +
      'function copyUrl() {' +
      '  navigator.clipboard.writeText("' + webAppUrl + '").then(() => {' +
      '    alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");' +
      '  });' +
      '}' +
      '</script>' +
      '</body>' +
      '</html>'
    )
    .setWidth(700)
    .setHeight(500);
    
    SpreadsheetApp.getUi().showModalDialog(html, 'Web App URL');
    
  } catch (error) {
    Logger.log('Error deploying web app: ' + error.toString());
    SpreadsheetApp.getUi().alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ deploy Web App: ' + error.toString());
  }
}